<div class="artwork">
  <img class="container-image" src="<%=
    artwork = @story.artwork_url
    if artwork == nil
      artwork = @story.user.avatar_url
    end 
    artwork.sub! "large", "crop"
     %>">
  <div class="forward">
     <span class="glyphicon glyphicon-forward"></span>
  </div>
  <div class="play-button">
     <span class="glyphicon glyphicon-play-circle"></span>
  </div>  
  <div class="rewind">
     <span class="glyphicons glyphicons-rewind"</span>
  </div>
</div>
</br>
</br>
<div class="story-place">@SoundCloud HQ</div>

<%= render partial: "create_comments" %>

<script>
  var story; 
  var playPauseButton = $('.play-button');
  var state = {
      isPlaying: false,
      isBuffering : false
  };
  var options = {
    onfinish : function(){
      playPauseButton.html('<span class="glyphicon glyphicon-play-circle"></span>');
      console.log("finish!!");
    }
  }

  SC.initialize({
    client_id: '69e93cf2209402f6f3137a6452cf498f'
  });
  playPauseButton.on('click', function(event) {
    if (story) {


      if (state.isPlaying) {
        story.pause();
        playPauseButton.html('<span class="glyphicon glyphicon-play-circle"></span>');
        state.isPlaying = false;
      } else {
        story.play();
        playPauseButton.html('<span class="glyphicon glyphicon-pause"></span>');
        state.isPlaying = true;
      }

    }else{
       state.isBuffering = true;
       playPauseButton.html('<span class="glyphicons glyphicon-cloud-download"></span>');
    }

  });
  SC.stream(<%= @story.id %>, options ,function(sound){
    //story = sound;
    console.log("story ready");


  });
</script>
