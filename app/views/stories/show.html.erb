<div class="artwork">
  <img class="container-image" src="<%=
    artwork = @story.artwork_url
    if artwork == nil
      artwork = @story.user.avatar_url
    end 
    artwork.sub! "large", "crop"
     %>">
 
  <div class="play-button">
     <span class="glyphicon glyphicon-play-circle"></span>
  </div>
</div>
</br>
</br>
<div class="story-place">@SoundCloud HQ</div>

<%= render partial: "create_comments" %>

<script>
  var playPauseButton = $('.play-button');
  var state = {
      isPlaying: false
  };
  var options = {
    onfinish : function(){
      playPauseButton.html('<span class="glyphicon glyphicon-play-circle"></span>');
      console.log("finish!!");
    }
  }

  SC.initialize({
    client_id: '69e93cf2209402f6f3137a6452cf498f'
  });

  SC.stream(<%= @story.id %>, options ,function(sound){
    playPauseButton.on('click', function(event) {
      if (state.isPlaying) {
        sound.pause();
        playPauseButton.html('<span class="glyphicon glyphicon-play-circle"></span>');
        state.isPlaying = false;
      } else {
        sound.play();
        playPauseButton.html('<span class="glyphicon glyphicon-pause"></span>');
        state.isPlaying = true;
      }
    });
    console.log("before load sound");
    sound.load();
  });
</script>
